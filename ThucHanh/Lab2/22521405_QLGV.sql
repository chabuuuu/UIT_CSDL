--  Nhập dữ liệu cho các bảng
SET DATEFORMAT DMY
INSERT KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES (N'KHMT', N'Khoa hoc may tinh', CAST(N'2005-06-07T00:00:00.000' AS DateTime), NULL)
INSERT KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES (N'HTTT', N'He thong thong tin', CAST(N'2005-06-07T00:00:00.000' AS DateTime), NULL)
INSERT KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES (N'CNPM', N'Cong nghe phan mem', CAST(N'2005-06-07T00:00:00.000' AS DateTime), NULL)
INSERT KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES (N'MTT', N'Mang va truyen thong', CAST(N'2005-10-20T00:00:00.000' AS DateTime), NULL)
INSERT KHOA (MAKHOA, TENKHOA, NGTLAP, TRGKHOA) VALUES (N'KTMT', N'Ky thuat may tinh', CAST(N'2005-12-20T00:00:00.000' AS DateTime), NULL)
GO

---------------------------------- MONHOC ---------------------------------------------

INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'THDC', N'Tin hoc dai cuong', 4, 1, N'KHMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'CTRR', N'Cau truc roi rac', 5, 0, N'KHMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'CSDL', N'Co so du lieu', 3, 1, N'HTTT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'CTDLGT', N'Cau truc du lieu va giai thuat', 3, 1, N'KHMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'PTTKTT', N'Phan tich thiet ke thuat toan', 3, 0, N'KHMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'DHMT', N'Do hoa may tinh', 3, 1, N'KHMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'KTMT', N'Kien truc may tinh', 3, 0, N'KTMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'TKCSDL', N'Thiet ke co so du lieu', 3, 1, N'HTTT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'PTTKHTTT', N'Phan tich thiet ke he thong thong tin', 4, 1, N'HTTT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'HDH', N'He dieu hanh', 4, 0, N'KTMT')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'NMCNPM', N'Nhap mon cong nghe phan mem', 3, 0, N'CNPM')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'LTCFW', N'Lap trinh C for win', 3, 1, N'CNPM')
INSERT MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES (N'LTHDT', N'Lap trinh huong doi tuong', 3, 1, N'CNPM')
GO

--------------------------------- DIEUKIEN --------------------------------------------
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'CSDL', N'CTRR')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'CSDL', N'CTDLGT')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'CTDLGT', N'THDC')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'PTTKTT', N'THDC')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'PTTKTT', N'CTDLGT')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'DHMT', N'THDC')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'LTHDT', N'THDC')
INSERT DIEUKIEN (MAMH, MAMH_TRUOC) VALUES (N'PTTKHTTT', N'CSDL')
GO

--------------------------------- GIAOVIEN --------------------------------------------
SET DATEFORMAT DMY
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV01', N'Ho Thanh Son', N'PTS', N'GS', N'Nam', CAST(N'1950-05-02T00:00:00.000' AS DateTime), CAST(N'2004-01-11T00:00:00.000' AS DateTime), 5, 2250000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV02', N'Tran Tam Thanh', N'TS', N'PGS', N'Nam', CAST(N'1965-12-17T00:00:00.000' AS DateTime), CAST(N'2004-04-20T00:00:00.000' AS DateTime), 4.5, 2025000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV03', N'Do Nghiem Phung', N'TS', N'GS', N'Nu', CAST(N'1950-08-01T00:00:00.000' AS DateTime), CAST(N'2004-09-23T00:00:00.000' AS DateTime), 4, 1800000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV04', N'Tran Nam Son', N'TS', N'PGS', N'Nam', CAST(N'1961-02-22T00:00:00.000' AS DateTime), CAST(N'2005-01-12T00:00:00.000' AS DateTime), 4.5, 2025000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV05', N'Mai Thanh Danh', N'ThS', N'GV', N'Nam', CAST(N'1958-03-12T00:00:00.000' AS DateTime), CAST(N'2005-01-12T00:00:00.000' AS DateTime), 3, 1350000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV06', N'Tran Doan Hung', N'TS', N'GV', N'Nam', CAST(N'1953-03-11T00:00:00.000' AS DateTime), CAST(N'2005-01-12T00:00:00.000' AS DateTime), 4.5, 2025000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV07', N'Nguyen Minh Tien', N'ThS', N'GV', N'Nam', CAST(N'1971-11-23T00:00:00.000' AS DateTime), CAST(N'2005-03-01T00:00:00.000' AS DateTime), 4, 1800000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV08', N'Le Thi Tran', N'KS', N'Null', N'Nu', CAST(N'1974-03-26T00:00:00.000' AS DateTime), CAST(N'2005-03-01T00:00:00.000' AS DateTime), 1.69, 760500, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV09', N'Nguyen To Lan', N'ThS', N'GV', N'Nu', CAST(N'1966-12-31T00:00:00.000' AS DateTime), CAST(N'2005-03-01T00:00:00.000' AS DateTime), 4, 1800000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV10', N'Le Tran Anh Loan', N'KS', N'Null', N'Nu', CAST(N'1972-07-17T00:00:00.000' AS DateTime), CAST(N'2005-03-01T00:00:00.000' AS DateTime), 1.86, 837000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV11', N'Ho Thanh Tung', N'CN', N'GV', N'Nam', CAST(N'1980-01-12T00:00:00.000' AS DateTime), CAST(N'2005-05-15T00:00:00.000' AS DateTime), 2.67, 1201500, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV12', N'Tran Van Anh', N'CN', N'Null', N'Nu', CAST(N'1981-03-29T00:00:00.000' AS DateTime), CAST(N'2005-05-15T00:00:00.000' AS DateTime), 1.69, 760500, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV13', N'Nguyen Linh Dan', N'CN', N'Null', N'Nu', CAST(N'1980-05-23T00:00:00.000' AS DateTime), CAST(N'2005-05-15T00:00:00.000' AS DateTime), 1.69, 760500, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV14', N'Truong Minh Chau', N'ThS', N'GV', N'Nu', CAST(N'1976-11-30T00:00:00.000' AS DateTime), CAST(N'2005-05-15T00:00:00.000' AS DateTime), 3, 1350000, NULL)
INSERT GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES (N'GV15', N'Le Ha Thanh', N'ThS', N'GV', N'Nam', CAST(N'1978-05-04T00:00:00.000' AS DateTime), CAST(N'2005-05-15T00:00:00.000' AS DateTime), 3, 1350000, NULL)
GO

----------------------------------- LOP -----------------------------------------------
INSERT LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES (N'K11', N'Lop 1 khoa 1', N'K1108', 11, N'GV07')
INSERT LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES (N'K12', N'Lop 2 khoa 1', N'K1205', 12, N'GV09')
INSERT LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES (N'K13', N'Lop 3 khoa 1', N'K1305', 12, N'GV14')
GO

--------------------------------- HOCVIEN ---------------------------------------------
SET DATEFORMAT DMY
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1101', N'Nguyen Van', N'A', CAST(N'1986-01-27T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1102', N'Tran Ngoc', N'Han', CAST(N'1986-03-14T00:00:00.000' AS DateTime), N'Nu', N'Kien Giang', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1103', N'Ha Duy', N'Lap', CAST(N'1986-04-18T00:00:00.000' AS DateTime), N'Nam', N'Nghe An', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1104', N'Tran Ngoc', N'Linh', CAST(N'1986-03-30T00:00:00.000' AS DateTime), N'Nu', N'Tay Ninh', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1105', N'Tran Minh', N'Long', CAST(N'1986-02-27T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1106', N'Le Nhat', N'Minh', CAST(N'1986-01-24T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1107', N'Nguyen Nhu', N'Nhut', CAST(N'1986-01-27T00:00:00.000' AS DateTime), N'Nam', N'Ha Noi', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1108', N'Nguyen Manh', N'Tam', CAST(N'1986-02-27T00:00:00.000' AS DateTime), N'Nam', N'Kien Giang', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1109', N'Phan Thi Thanh', N'Tam', CAST(N'1986-01-27T00:00:00.000' AS DateTime), N'Nu', N'Vinh Long', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1110', N'Le Hoai', N'Thuong', CAST(N'1986-02-05T00:00:00.000' AS DateTime), N'Nu', N'Can Tho', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1111', N'Le Ha', N'Vinh', CAST(N'1986-12-25T00:00:00.000' AS DateTime), N'Nam', N'Vinh Long', N'K11')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1201', N'Nguyen Van', N'B', CAST(N'1986-02-11T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1202', N'Nguyen Thi Kim', N'Duyen', CAST(N'1986-01-18T00:00:00.000' AS DateTime), N'Nu', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1203', N'Tran Thi Kim', N'Duyen', CAST(N'1986-09-17T00:00:00.000' AS DateTime), N'Nu', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1204', N'Truong My', N'Hanh', CAST(N'1986-05-19T00:00:00.000' AS DateTime), N'Nu', N'Dong Nai', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1205', N'Nguyen Thanh', N'Nam', CAST(N'1986-04-17T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1206', N'Nguyen Thi Truc', N'Thanh', CAST(N'1986-03-04T00:00:00.000' AS DateTime), N'Nu', N'Kien Giang', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1207', N'Tran Thi Bich', N'Thuy', CAST(N'1986-02-08T00:00:00.000' AS DateTime), N'Nu', N'Nghe An', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1208', N'Huynh Thi Kim', N'Trieu', CAST(N'1986-04-08T00:00:00.000' AS DateTime), N'Nu', N'Tay Ninh', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1209', N'Pham Thanh', N'Trieu', CAST(N'1986-02-23T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1210', N'Ngo Thanh', N'Tuan', CAST(N'1986-02-14T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1211', N'Do Thi', N'Xuan', CAST(N'1986-03-09T00:00:00.000' AS DateTime), N'Nu', N'Ha Noi', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1212', N'Le Thi Phi', N'Yen', CAST(N'1986-03-12T00:00:00.000' AS DateTime), N'Nu', N'TpHCM', N'K12')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1301', N'Nguyen Thi Kim', N'Cuc', CAST(N'1986-06-09T00:00:00.000' AS DateTime), N'Nu', N'Kien Giang', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1302', N'Truong Thi My', N'Hien', CAST(N'1986-03-18T00:00:00.000' AS DateTime), N'Nu', N'Nghe An', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1303', N'Le Duc', N'Hien', CAST(N'1986-03-21T00:00:00.000' AS DateTime), N'Nam', N'Tay Ninh', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1304', N'Le Quang', N'Hien', CAST(N'1986-04-18T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1305', N'Le Thi', N'Huong', CAST(N'1986-03-27T00:00:00.000' AS DateTime), N'Nu', N'TpHCM', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1306', N'Nguyen Thai', N'Huu', CAST(N'1986-03-30T00:00:00.000' AS DateTime), N'Nam', N'Ha Noi', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1307', N'Tran Minh', N'Man', CAST(N'1986-05-28T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1308', N'Nguyen Hieu', N'Nghia', CAST(N'1986-04-08T00:00:00.000' AS DateTime), N'Nam', N'Kien Giang', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1309', N'Nguyen Trung', N'Nghia', CAST(N'1987-01-18T00:00:00.000' AS DateTime), N'Nam', N'Nghe An', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1310', N'Tran Thi Hong', N'Tham', CAST(N'1986-04-22T00:00:00.000' AS DateTime), N'Nu', N'Tay Ninh', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1311', N'Tran Minh', N'Thuc', CAST(N'1986-04-04T00:00:00.000' AS DateTime), N'Nam', N'TpHCM', N'K13')
INSERT HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES (N'K1312', N'Nguyen Thi Kim', N'Yen', CAST(N'1986-09-07T00:00:00.000' AS DateTime), N'Nu', N'TpHCM', N'K13')
GO

--------------------------------- GIANGDAY --------------------------------------------
SET DATEFORMAT DMY
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K11', N'THDC', N'GV07', 1, 2006, CAST(N'2006-01-02T00:00:00.000' AS DateTime), CAST(N'2006-05-12T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K12', N'THDC', N'GV06', 1, 2006, CAST(N'2006-01-02T00:00:00.000' AS DateTime), CAST(N'2006-05-12T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K13', N'THDC', N'GV15', 1, 2006, CAST(N'2006-01-02T00:00:00.000' AS DateTime), CAST(N'2006-05-12T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K11', 'CTRR', N'GV02', 1, 2006, CAST(N'2006-01-09T00:00:00.000' AS DateTime), CAST(N'2006-05-17T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K12', N'CTRR', N'GV02', 1, 2006, CAST(N'2006-01-09T00:00:00.000' AS DateTime), CAST(N'2006-05-17T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K13', N'CTRR', N'GV08', 1, 2006, CAST(N'2006-01-09T00:00:00.000' AS DateTime), CAST(N'2006-05-17T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K11', N'CSDL', N'GV05', 2, 2006, CAST(N'2006-06-01T00:00:00.000' AS DateTime), CAST(N'2006-07-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K12', N'CSDL', N'GV09', 2, 2006, CAST(N'2006-06-01T00:00:00.000' AS DateTime), CAST(N'2006-07-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K13', N'CTDLGT', N'GV15', 2, 2006, CAST(N'2006-06-01T00:00:00.000' AS DateTime), CAST(N'2006-07-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K13', N'CSDL', N'GV05', 3, 2006, CAST(N'2006-08-01T00:00:00.000' AS DateTime), CAST(N'2006-12-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K13', N'DHMT', N'GV07', 3, 2006, CAST(N'2006-08-01T00:00:00.000' AS DateTime), CAST(N'2006-12-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K11', N'CTDLGT', N'GV15', 3, 2006, CAST(N'2006-08-01T00:00:00.000' AS DateTime), CAST(N'2006-12-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K12', N'CTDLGT', N'GV15', 3, 2006, CAST(N'2006-08-01T00:00:00.000' AS DateTime), CAST(N'2006-12-15T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K11', N'HDH', N'GV04', 1, 2007, CAST(N'2007-01-02T00:00:00.000' AS DateTime), CAST(N'2007-02-18T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K12', N'HDH', N'GV04', 1, 2007, CAST(N'2007-01-02T00:00:00.000' AS DateTime), CAST(N'2007-03-20T00:00:00.000' AS DateTime))
INSERT GIANGDAY (MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES (N'K11', N'DHMT', N'GV07', 1, 2007, CAST(N'2007-02-18T00:00:00.000' AS DateTime), CAST(N'2007-03-20T00:00:00.000' AS DateTime))
GO

--------------------------------- KETQUATHI -------------------------------------------
SET DATEFORMAT DMY
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1101', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 10, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1101', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 9, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1101', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 9, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1101', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 9.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CSDL', 2, CAST(N'2006-07-27T00:00:00.000' AS DateTime), 4.25, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CSDL', 3, CAST(N'2006-08-10T00:00:00.000' AS DateTime), 4.5, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 4.5, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CTDLGT', 2, CAST(N'2007-01-05T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CTDLGT', 3, CAST(N'2007-01-15T00:00:00.000' AS DateTime), 6, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1102', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 7, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1103', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 3.5, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1103', N'CSDL', 2, CAST(N'2006-07-27T00:00:00.000' AS DateTime), 8.25, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1103', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 7, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1103', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 8, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1103', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 6.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1104', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 3.75, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1104', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1104', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1104', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1104', N'CTRR', 2, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 3.5, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1104', N'CTRR', 3, CAST(N'2006-06-30T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1201', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 6, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1201', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1201', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 8.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1201', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 9, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 8, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'CTDLGT', 2, CAST(N'2007-01-05T00:00:00.000' AS DateTime), 5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'THDC', 2, CAST(N'2006-05-27T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 3, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'CTRR', 2, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1202', N'CTRR', 3, CAST(N'2006-06-30T00:00:00.000' AS DateTime), 6.25, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1203', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 9.25, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1203', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 9.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1203', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 10, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1203', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 10, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1204', N'CSDL', 1, CAST(N'2006-07-20T00:00:00.000' AS DateTime), 8.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1204', N'CTDLGT', 1, CAST(N'2006-12-28T00:00:00.000' AS DateTime), 6.75, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1204', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1204', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 6, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1301', N'CSDL', 1, CAST(N'2006-12-20T00:00:00.000' AS DateTime), 4.25, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1301', N'CTDLGT', 1, CAST(N'2006-07-25T00:00:00.000' AS DateTime), 8, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1301', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 7.75, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1301', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 8, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1302', N'CSDL', 1, CAST(N'2006-12-20T00:00:00.000' AS DateTime), 6.75, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1302', N'CTDLGT', 1, CAST(N'2006-07-25T00:00:00.000' AS DateTime), 5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1302', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 8, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1302', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 8.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'CSDL', 1, CAST(N'2006-12-20T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'CTDLGT', 1, CAST(N'2006-07-25T00:00:00.000' AS DateTime), 4.5, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'CTDLGT', 2, CAST(N'2006-08-07T00:00:00.000' AS DateTime), 4, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'CTDLGT', 3, CAST(N'2006-08-15T00:00:00.000' AS DateTime), 4.25, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 4.5, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 3.25, N'Khong Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1303', N'CTRR', 2, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1304', N'CSDL', 1, CAST(N'2006-12-20T00:00:00.000' AS DateTime), 7.75, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1304', N'CTDLGT', 1, CAST(N'2006-07-25T00:00:00.000' AS DateTime), 9.75, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1304', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 5.5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1304', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 5, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1305', N'CSDL', 1, CAST(N'2006-12-20T00:00:00.000' AS DateTime), 9.25, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1305', N'CTDLGT', 1, CAST(N'2006-07-25T00:00:00.000' AS DateTime), 10, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1305', N'THDC', 1, CAST(N'2006-05-20T00:00:00.000' AS DateTime), 8, N'Dat')
INSERT KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES (N'K1305', N'CTRR', 1, CAST(N'2006-05-13T00:00:00.000' AS DateTime), 10, N'Dat')
GO

UPDATE KHOA SET TRGKHOA = N'GV01' WHERE MAKHOA = N'KHMT'
UPDATE KHOA SET TRGKHOA = N'GV02' WHERE MAKHOA = N'HTTT'
UPDATE KHOA SET TRGKHOA = N'GV03' WHERE MAKHOA = N'CNPM'
UPDATE KHOA SET TRGKHOA = N'GV04' WHERE MAKHOA = N'MTT'
UPDATE KHOA SET TRGKHOA = N'Null' WHERE MAKHOA = N'KTMT'

UPDATE GIAOVIEN SET MAKHOA = N'KHMT' WHERE MAGV = N'GV01'
UPDATE GIAOVIEN SET MAKHOA = N'HTTT' WHERE MAGV = N'GV02'
UPDATE GIAOVIEN SET MAKHOA = N'CNPM' WHERE MAGV = N'GV03'
UPDATE GIAOVIEN SET MAKHOA = N'KTMT' WHERE MAGV = N'GV04'
UPDATE GIAOVIEN SET MAKHOA = N'HTTT' WHERE MAGV = N'GV05'
UPDATE GIAOVIEN SET MAKHOA = N'KHMT' WHERE MAGV = N'GV06'
UPDATE GIAOVIEN SET MAKHOA = N'KHMT' WHERE MAGV = N'GV07'
UPDATE GIAOVIEN SET MAKHOA = N'KHMT' WHERE MAGV = N'GV08'
UPDATE GIAOVIEN SET MAKHOA = N'HTTT' WHERE MAGV = N'GV09'
UPDATE GIAOVIEN SET MAKHOA = N'CNPM' WHERE MAGV = N'GV10'
UPDATE GIAOVIEN SET MAKHOA = N'MTT' WHERE MAGV = N'GV11'
UPDATE GIAOVIEN SET MAKHOA = N'CNPM' WHERE MAGV = N'GV12'
UPDATE GIAOVIEN SET MAKHOA = N'KTMT' WHERE MAGV = N'GV13'
UPDATE GIAOVIEN SET MAKHOA = N'MTT' WHERE MAGV = N'GV14'
UPDATE GIAOVIEN SET MAKHOA = N'KHMT' WHERE MAGV = N'GV15'



--I.

-- 11.	Học viên ít nhất là 18 tuổi.
ALTER TABLE HOCVIEN ADD CONSTRAINT CK_TUOI 
CHECK(GETDATE() - NGSINH >= 18)


-- 12.	Giảng dạy một môn học ngày bắt đầu (TUNGAY) phải nhỏ hơn ngày kết thúc (DENNGAY).
ALTER TABLE GIANGDAY ADD CONSTRAINT CK_NGAY 
CHECK(TUNGAY < DENNGAY)


-- 13.
ALTER TABLE GIAOVIEN ADD CONSTRAINT CK_NGVL 
CHECK(GETDATE() - NGVL >= 22)


-- 14.	Tất cả các môn học đều có số tín chỉ lý thuyết và tín chỉ thực hành chênh lệch nhau không quá 3.
ALTER TABLE MONHOC ADD CONSTRAINT CK_TC 
CHECK(ABS(TCLT - TCTH) <= 3)




-- III. 
-- 1.	In ra danh sách (mã học viên, họ tên, ngày sinh, mã lớp) lớp trưởng của các lớp.
SELECT HV.MAHV, HO + ' ' + TEN AS HOTEN, NGSINH, HV.MALOP 
FROM HOCVIEN HV INNER JOIN LOP 
ON HV.MAHV = LOP.TRGLOP


-- 2.	In ra bảng điểm khi thi (mã học viên, họ tên , lần thi, điểm số) môn CTRR của lớp “K12”, sắp xếp theo tên, họ học viên.
SELECT KQ.MAHV, HO + ' ' + TEN AS HOTEN, LANTHI, DIEM 
FROM KETQUATHI KQ INNER JOIN HOCVIEN HV 
ON KQ.MAHV = HV.MAHV
WHERE LEFT(KQ.MAHV, 3) = 'K12' AND MAMH = 'CTRR'
ORDER BY TEN, HO


-- 3.	In ra danh sách những học viên (mã học viên, họ tên) và những môn học mà học viên đó thi lần thứ nhất đã đạt.
SELECT KQ.MAHV, HO + ' ' + TEN AS HOTEN, MAMH
FROM KETQUATHI KQ INNER JOIN HOCVIEN HV 
ON KQ.MAHV = HV.MAHV
GROUP BY KQ.MAHV, HO, TEN, MAMH, KQUA
HAVING MAX(LANTHI) = 1 AND KQUA ='DAT'
ORDER BY KQ.MAHV


-- 4.	In ra danh sách học viên (mã học viên, họ tên) của lớp “K11” thi môn CTRR không đạt (ở lần thi 1).
SELECT KQ.MAHV, HO + ' ' + TEN AS HOTEN
FROM KETQUATHI KQ INNER JOIN HOCVIEN HV 
ON KQ.MAHV = HV.MAHV
WHERE LEFT(KQ.MAHV, 3) = 'K11' AND MAMH = 'CTRR' AND LANTHI = 1 AND KQUA = 'Khong Dat'